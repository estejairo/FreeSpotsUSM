{"files":[{"id":"800ec1a7-8d7c-447a-9c0f-cf41f9961948","name":"CÃ³digo","type":"server_js","source":"var ss \u003d SpreadsheetApp.openByUrl(\"https://docs.google.com/spreadsheets/d/16Wa6YupvQ9CVkOUp0jpaw4HL2RV996oygxTVhvlcRRE/edit#gid\u003d0\");\n\nvar sheet \u003d ss.getSheetByName(\u0027Spots\u0027); // be very careful ... it is the sheet name .. so it should match \n\n\nfunction doPost(e){\nvar action \u003d e.parameter.action;\n\n  if(action \u003d\u003d \u0027addItem\u0027){\n    return addItem(e);\n  }\n  else if(action \u003d\u003d \u0027updateItem\u0027){\n    return updateItem(e);\n  }\n}\n\nfunction doGet(e){\n  var action \u003d e.parameter.action;\n  if(action \u003d\u003d \u0027getItems\u0027){\n    return getItems(e);\n  }\n}\n\n\nfunction updateItem(e){\n\n  var id  \u003d  e.parameter.id;\n  \n  var state \u003d e.parameter.state;\n  \n  var user \u003d e.parameter.user;\n  \n  var date \u003d  new Date();\n  \n  var rows \u003d sheet.getRange(1, 1, sheet.getLastRow(),sheet.getLastColumn()).getValues();\n  \n  for (var r \u003d 0, l \u003d rows.length; r \u003c l; r++) {\n    var row \u003d rows[r];\n    if (row[0] \u003d\u003d id){\n      sheet.deleteRow(r+1);\n      sheet.appendRow([id,state,user,date]);\n      sheet.sort(1);\n      return ContentService.createTextOutput(\"Success.\").setMimeType(ContentService.MimeType.TEXT);\n    }\n  }\n  return ContentService.createTextOutput(\"Error: No Such ID.\").setMimeType(ContentService.MimeType.TEXT);\n}\n\nfunction addItem(e){\n\n  var id  \u003d  \"Item\"+sheet.getLastRow(); // Item1\n\n  var state \u003d \"1\";\n\n  var user \u003d e.parameter.user;\n  \n  var date \u003d  \"zapallo\";\n  \n  sheet.appendRow([id,state,user,date]);\n\n   return ContentService.createTextOutput(\"Success.\").setMimeType(ContentService.MimeType.TEXT);\n\n}\n\nfunction getItems(e){\n  \n  var records\u003d{};\n \n  var rows \u003d sheet.getRange(1, 1, sheet.getLastRow(),sheet.getLastColumn()).getValues();\n      data \u003d [];\n\n  for (var r \u003d 0, l \u003d rows.length; r \u003c l; r++) {\n    var row     \u003d rows[r],\n        record  \u003d {};\n    record[\u0027id\u0027] \u003d row[0];\n    record[\u0027state\u0027]\u003drow[1];\n    record[\u0027user\u0027]\u003drow[2];\n    \n    data.push(record);\n    \n   }\n  records.items \u003d data;\n  var result\u003dJSON.stringify(records);\n  return ContentService.createTextOutput(result).setMimeType(ContentService.MimeType.JSON);\n}\n"},{"id":"c678f9fe-496d-4f58-935d-8a8a2d5dd1c5","name":"appsscript","type":"json","source":"{\n  \"timeZone\": \"America/Santiago\",\n  \"dependencies\": {\n  },\n  \"webapp\": {\n    \"access\": \"ANYONE_ANONYMOUS\",\n    \"executeAs\": \"USER_DEPLOYING\"\n  },\n  \"exceptionLogging\": \"STACKDRIVER\"\n}"}]}